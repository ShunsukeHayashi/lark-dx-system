# Lark DX統合管理システム設計書

## 概要
このドキュメントは、Lark DX社のDXコンサルティング業務を効率化するためのLark Base統合管理システムの設計仕様書です。

## C1: システム構造分析・設計

### 会社情報
- **会社名**: Lark DX
- **事業内容**: DXとAIを活用したコラボレーションツールの提供
- **主要サービス**: 
  - DX導入コンサルティング
  - AI活用支援
  - ワークフロー最適化
  - チームコラボレーション強化

### T1: システム要件定義

#### アプリケーション概要
- **アプリケーション名**: DXコンサルティング統合管理システム
- **目的**: Lark DXのDXコンサルティング業務を効率化し、顧客管理から案件進捗まで一元管理

#### 主要業務
1. **DX導入コンサルティング管理**
   - 初回相談から導入完了までのプロセス管理
   - 顧客のDX成熟度評価と提案管理
   
2. **顧客サポート・実装支援管理**
   - 導入支援プロジェクトの進捗管理
   - 顧客問い合わせとサポート履歴管理
   
3. **AI活用・ワークフロー最適化管理**
   - AI機能活用状況のトラッキング
   - ワークフロー改善提案と効果測定

#### 利用規模
- **利用者数**: 10-50名（コンサルタント、サポートスタッフ、マネージャー）
- **管理対象数**: 
  - 初期: 100社（継続的に月10社ペースで増加見込み）
  - 取引先数: 500社
  - チャネル数: 3（直販、パートナー経由、ウェブ）
- **月間処理件数**: 200-500件（相談、サポート、プロジェクト）

#### 重要KPI
- 導入完了までのリードタイム
- 顧客満足度スコア
- AI機能活用率
- プロジェクト成功率

### T2: データ構造設計

#### 1. マスターテーブル（静的データ）

##### 顧客マスタ
- **目的**: 顧客企業の基本情報管理
- **主要項目**: 
  - 企業名
  - 業界
  - 企業規模
  - DX成熟度レベル
  - 契約ステータス

##### コンサルタントマスタ
- **目的**: 社内コンサルタント情報管理
- **主要項目**:
  - コンサルタント名
  - 専門分野
  - スキルレベル
  - 担当可能業界
  - 稼働状況

##### サービスカタログマスタ
- **目的**: DXサービスメニュー管理
- **主要項目**:
  - サービス名
  - サービスカテゴリ（AI機能、ワークフロー最適化、導入支援など）
  - 標準価格
  - 提供期間
  - 必要スキル

##### 業界マスタ
- **目的**: 対象業界分類と特性管理
- **主要項目**:
  - 業界名
  - 業界コード
  - 典型的なDX課題
  - 推奨ソリューション

#### 2. トランザクションテーブル（動的データ）

##### 案件管理テーブル
- **目的**: DXコンサルティング案件の全体管理
- **主要項目**:
  - 案件ID
  - 顧客名（顧客マスタ参照）
  - 担当コンサルタント（コンサルタントマスタ参照）
  - ステータス（初回相談、提案中、実装中、導入完了）
  - 開始日
  - 完了予定日

##### プロジェクトタスクテーブル
- **目的**: 各案件の詳細タスク管理
- **主要項目**:
  - タスクID
  - 案件ID（案件管理テーブル参照）
  - タスク名
  - 担当者
  - ステータス
  - 期限
  - 進捗率

##### 顧客対応履歴テーブル
- **目的**: 問い合わせ、サポート履歴管理
- **主要項目**:
  - 対応ID
  - 顧客名（顧客マスタ参照）
  - 対応日時
  - 対応種別（問い合わせ、サポート、定期MTG）
  - 対応内容
  - 対応者

##### 効果測定テーブル
- **目的**: DX導入効果の定量的管理
- **主要項目**:
  - 測定ID
  - 案件ID（案件管理テーブル参照）
  - 測定日
  - AI活用率
  - 業務時間削減率
  - コスト削減額
  - ROI

#### 3. 関連テーブル

##### 提案書テーブル
- **目的**: DX導入提案書の管理
- **主要項目**:
  - 提案書ID
  - 案件ID（案件管理テーブル参照）
  - 提案日
  - 提案内容
  - 見積金額
  - 承認ステータス

##### ナレッジベーステーブル
- **目的**: 成功事例、ベストプラクティス管理
- **主要項目**:
  - ナレッジID
  - カテゴリ
  - タイトル
  - 内容
  - 業界（業界マスタ参照）
  - 効果実績

##### 請求・契約テーブル
- **目的**: 契約情報と請求管理
- **主要項目**:
  - 契約ID
  - 顧客名（顧客マスタ参照）
  - 契約種別（単発、サブスクリプション）
  - 契約金額
  - 契約期間
  - 請求ステータス

## C2: フィールド設計・実装

### T0: 主キー設計

#### マスターテーブルの主キー設定

1. **顧客マスタ**
   - フィールド名: 顧客名
   - タイプ: テキスト（直接入力）
   - 位置: 最左端
   - 制約: 必須、ユニーク
   - 形式: 株式会社○○

2. **コンサルタントマスタ**
   - フィールド名: コンサルタント名
   - タイプ: テキスト（直接入力）
   - 位置: 最左端
   - 制約: 必須、ユニーク
   - 形式: 山田太郎

3. **サービスカタログマスタ**
   - フィールド名: サービスコード
   - タイプ: テキスト（直接入力）
   - 位置: 最左端
   - 制約: 必須、ユニーク
   - 形式: SVC-AI-001

4. **業界マスタ**
   - フィールド名: 業界名
   - タイプ: テキスト（直接入力）
   - 位置: 最左端
   - 制約: 必須、ユニーク
   - 形式: 製造業

#### トランザクションテーブルの主キー設定

1. **案件管理テーブル**
   - フィールド名: 案件ID
   - タイプ: 数式
   - 数式: `CONCATENATE(TEXT(相談日, "YYYY-MM-DD"), "_", 顧客名, "_", LEFT(案件概要, 20))`
   - 位置: 最左端
   - 表示例: "2024-01-15_株式会社ABC_DX導入コンサルティング"

2. **プロジェクトタスクテーブル**
   - フィールド名: タスクID
   - タイプ: 数式
   - 数式: `CONCATENATE("[", 優先度, "]", TEXT(期限, "MM/DD"), "_", 案件ID, "_", タスク名)`
   - 位置: 最左端
   - 表示例: "[高]01/20_2024-01-15_株式会社ABC_要件定義書作成"

3. **顧客対応履歴テーブル**
   - フィールド名: 対応ID
   - タイプ: 数式
   - 数式: `CONCATENATE(TEXT(対応日時, "YYYY-MM-DD HH:mm"), "_", 顧客名, "_", 対応種別)`
   - 位置: 最左端
   - 表示例: "2024-01-15 14:30_株式会社ABC_定期MTG"

4. **効果測定テーブル**
   - フィールド名: 測定ID
   - タイプ: 数式
   - 数式: `CONCATENATE(TEXT(測定日, "YYYY-MM"), "_", 案件ID, "_", "効果測定")`
   - 位置: 最左端
   - 表示例: "2024-01_2024-01-15_株式会社ABC_効果測定"

### T1: マスターフィールド設計

#### 顧客マスタ
- **顧客名**（テキスト）: 主キー、最左端
- **業界**（単一選択）:
  - 選択肢: 製造業, 小売業, 金融業, ITサービス, 医療・福祉, 教育, その他
  - 色: 標準色パレット使用
- **企業規模**（単一選択）:
  - 選択肢: 大企業（1000名以上）, 中堅企業（100-999名）, 中小企業（10-99名）, スタートアップ（1-9名）
- **DX成熟度**（単一選択）:
  - 選択肢: 初級（デジタル未導入）, 中級（一部デジタル化）, 上級（デジタル化進行中）, 最上級（DX推進中）
- **契約ステータス**（単一選択）:
  - 有効: 🟢緑（1行目5番目）
  - 無効: 🤍グレー（1行目11番目）
- **担当コンサルタント**（ユーザー）: 単一選択
- **連絡先**（テキスト）: 住所、電話番号、メールアドレス
- **登録日**（日付）: デフォルトTODAY()
- **最終更新日**（日付）: デフォルトTODAY()
- **備考**（テキスト）: 複数行

#### コンサルタントマスタ
- **コンサルタント名**（テキスト）: 主キー、最左端
- **専門分野**（複数選択）:
  - 選択肢: AI活用, ワークフロー最適化, チームコラボ, データ分析, セキュリティ
- **スキルレベル**（単一選択）:
  - 選択肢: ジュニア, ミドル, シニア, エキスパート
- **担当可能業界**（複数選択）:
  - 選択肢: 顧客マスタの業界と同一
- **稼働ステータス**（単一選択）:
  - 待機中: 🟢緑
  - 稼働中: 🟡黄
  - 休暇中: 🤍グレー
- **現在の担当案件数**（数値）: デフォルト0
- **入社日**（日付）
- **資格・認定**（テキスト）: 複数行

#### サービスカタログマスタ
- **サービスコード**（テキスト）: 主キー、最左端
- **サービス名**（テキスト）
- **サービスカテゴリ**（単一選択）:
  - 選択肢: AI機能導入, ワークフロー最適化, チームコラボ支援, 導入コンサルティング, トレーニング
- **標準価格**（通貨）: JPY
- **提供期間**（テキスト）: 例：3ヶ月、継続
- **必要スキル**（複数選択）: コンサルタントの専門分野と同一
- **サービス説明**（テキスト）: 複数行
- **ステータス**（単一選択）:
  - 有効: 🟢緑
  - 無効: 🤍グレー

#### 業界マスタ
- **業界名**（テキスト）: 主キー、最左端
- **業界コード**（テキスト）: 例：IND-MFG-001
- **典型的なDX課題**（テキスト）: 複数行
- **推奨ソリューション**（テキスト）: 複数行
- **優先度**（単一選択）:
  - 高: ❤️赤
  - 中: 🔵青
  - 低: 🤍グレー

### T2: トランザクションフィールド設計

#### 案件管理テーブル
- **案件ID**（数式）: 主キー、最左端
- **相談日**（日付）: 初回相談日
- **顧客名**（リンク）: 顧客マスタ参照
- **案件概要**（テキスト）: 案件の簡潔な説明
- **担当コンサルタント**（リンク）: コンサルタントマスタ参照
- **ステータス**（単一選択）:
  - 初回相談: 🔵青
  - 提案中: 🟡黄
  - 実装中: 🟠オレンジ
  - 導入完了: 🟢緑
  - 保留: 🤍グレー
  - キャンセル: ❤️赤
- **優先度**（単一選択）:
  - 緊急: ❤️赤
  - 高: 🟡黄
  - 中: 🔵青
  - 低: 🤍グレー
- **顧客DX成熟度**（ルックアップ）: 顧客マスタから参照
- **提案金額**（通貨）: JPY
- **契約金額**（通貨）: JPY
- **開始日**（日付）: プロジェクト開始日
- **完了予定日**（日付）
- **実際完了日**（日付）
- **進捗率**（数値）: 0-100%
- **メモ**（テキスト）: 複数行

#### プロジェクトタスクテーブル
- **タスクID**（数式）: 主キー、最左端
- **案件ID**（リンク）: 案件管理テーブル参照
- **タスク名**（テキスト）
- **タスクカテゴリ**（単一選択）:
  - 選択肢: 要件定義, 設計, 実装, テスト, トレーニング, その他
- **担当者**（ユーザー）: 複数選択可
- **ステータス**（単一選択）:
  - 未着手: 🤍グレー
  - 進行中: 🟡黄
  - 完了: 🟢緑
  - 保留: 🟠オレンジ
  - キャンセル: ❤️赤
- **優先度**（単一選択）: 案件管理テーブルと同一
- **開始日**（日付）
- **期限**（日付）
- **完了日**（日付）
- **進捗率**（数値）: 0-100%
- **作業時間**（数値）: 時間単位
- **コメント**（テキスト）: 複数行

#### 顧客対応履歴テーブル
- **対応ID**（数式）: 主キー、最左端
- **対応日時**（日時）
- **顧客名**（リンク）: 顧客マスタ参照
- **案件ID**（リンク）: 案件管理テーブル参照（オプション）
- **対応種別**（単一選択）:
  - 選択肢: 問い合わせ, サポート, 定期MTG, トラブル対応, その他
- **対応内容**（テキスト）: 複数行
- **対応者**（ユーザー）
- **対応時間**（数値）: 分単位
- **満足度**（単一選択）:
  - 選択肢: 非常に満足, 満足, 普通, 不満, 非常に不満
- **フォローアップ必要**（チェックボックス）
- **添付ファイル**（添付）

#### 効果測定テーブル
- **測定ID**（数式）: 主キー、最左端
- **案件ID**（リンク）: 案件管理テーブル参照
- **測定日**（日付）
- **測定期間**（単一選択）:
  - 選択肢: 導入前, 1ヶ月後, 3ヶ月後, 6ヶ月後, 1年後
- **AI活用率**（数値）: %
- **業務時間削減率**（数値）: %
- **コスト削減額**（通貨）: JPY
- **生産性向上率**（数値）: %
- **従業員満足度**（数値）: 1-10点
- **ROI**（数値）: %
- **評価コメント**（テキスト）: 複数行
- **次回アクション**（テキスト）: 複数行

### T3: 数式フィールド設計

#### 案件管理テーブルの数式フィールド

1. **残日数**
   - 数式: `IF(ステータス != "導入完了", 完了予定日 - TODAY(), "完了済")`
   - 目的: プロジェクト期限までの日数管理

2. **リードタイム**
   - 数式: `IF(実際完了日 != "", 実際完了日 - 相談日, TODAY() - 相談日)`
   - 目的: 初回相談から完了までの日数追跡

3. **ステータスアラート**
   - 数式: `IF(残日数 < 0, "🚨遅延", IF(残日数 < 7, "⚠️期限近い", "✅正常"))`
   - 目的: プロジェクト進捗の視覚的警告

4. **契約率**
   - 数式: `IF(提案金額 > 0, 契約金額 / 提案金額 * 100, 0)`
   - 目的: 提案から契約への転換率計算

#### プロジェクトタスクテーブルの数式フィールド

1. **タスク残日数**
   - 数式: `IF(ステータス != "完了", 期限 - TODAY(), "完了済")`
   - 目的: タスク単位での期限管理

2. **遅延フラグ**
   - 数式: `IF(AND(ステータス != "完了", 期限 < TODAY()), "🔴遅延", "")`
   - 目的: 遅延タスクの即座識別

3. **実作業日数**
   - 数式: `IF(完了日 != "", 完了日 - 開始日, IF(開始日 != "", TODAY() - 開始日, 0))`
   - 目的: 実際の作業日数計測

#### 顧客対応履歴テーブルの数式フィールド

1. **対応所要時間**
   - 数式: `IF(対応時間 > 60, CONCATENATE(INT(対応時間/60), "時間", MOD(対応時間, 60), "分"), CONCATENATE(対応時間, "分"))`
   - 目的: 分単位を時間分表示に変換

2. **満足度スコア**
   - 数式: `SWITCH(満足度, "非常に満足", 5, "満足", 4, "普通", 3, "不満", 2, "非常に不満", 1, 0)`
   - 目的: 満足度を数値化して集計可能に

#### 効果測定テーブルの数式フィールド

1. **総合改善率**
   - 数式: `(AI活用率 + 業務時間削減率 + 生産性向上率) / 3`
   - 目的: DX導入効果の総合指標

2. **投資回収期間**
   - 数式: `IF(コスト削減額 > 0, ROUND(契約金額 / (コスト削減額 * 12), 1), "計算不可")`
   - 目的: 月単位での投資回収期間計算

3. **効果判定**
   - 数式: `IF(総合改善率 >= 70, "🌟非常に良好", IF(総合改善率 >= 50, "🟢良好", IF(総合改善率 >= 30, "🟡標準", "🔴改善必要")))`
   - 目的: 効果の視覚的評価

#### 共通ルックアップフィールド

1. **顧客情報ルックアップ**
   - 顧客の業界
   - 顧客の企業規模
   - 顧客のDX成熟度

2. **コンサルタント情報ルックアップ**
   - コンサルタントの稼働ステータス
   - コンサルタントの専門分野

## C3: リレーション構築

### T1: リレーション設定準備

#### テーブル作成確認
- ✓ 顧客マスタ: 主キー「顧客名」設定済
- ✓ コンサルタントマスタ: 主キー「コンサルタント名」設定済
- ✓ サービスカタログマスタ: 主キー「サービスコード」設定済
- ✓ 業界マスタ: 主キー「業界名」設定済
- ✓ 案件管理テーブル: 主キー「案件ID」設定済
- ✓ プロジェクトタスクテーブル: 主キー「タスクID」設定済
- ✓ 顧客対応履歴テーブル: 主キー「対応ID」設定済
- ✓ 効果測定テーブル: 主キー「測定ID」設定済

#### リレーション設定順序
1. トランザクション → マスターの順で設定
2. 双方向リンクの自動生成を確認
3. プレビュー表示フィールドを最大3つまで設定

### T2: 双方向リンク作成

#### 1. 案件管理 → 顧客マスタ
- **フィールド名**: 顧客名（既存）
- **参照テーブル**: 顧客マスタ
- **参照フィールド**: 顧客名
- **選択可能数**: 単一
- **逆方向リンク**: 顧客マスタに「関連案件」自動生成

#### 2. 案件管理 → コンサルタントマスタ
- **フィールド名**: 担当コンサルタント（既存）
- **参照テーブル**: コンサルタントマスタ
- **参照フィールド**: コンサルタント名
- **選択可能数**: 単一
- **逆方向リンク**: コンサルタントマスタに「担当案件」自動生成

#### 3. プロジェクトタスク → 案件管理
- **フィールド名**: 案件ID（既存）
- **参照テーブル**: 案件管理テーブル
- **参照フィールド**: 案件ID
- **選択可能数**: 単一
- **逆方向リンク**: 案件管理テーブルに「関連タスク」自動生成

#### 4. 顧客対応履歴 → 顧客マスタ
- **フィールド名**: 顧客名（既存）
- **参照テーブル**: 顧客マスタ
- **参照フィールド**: 顧客名
- **選択可能数**: 単一
- **逆方向リンク**: 顧客マスタに「対応履歴」自動生成

#### 5. 顧客対応履歴 → 案件管理（オプション）
- **フィールド名**: 案件ID（既存）
- **参照テーブル**: 案件管理テーブル
- **参照フィールド**: 案件ID
- **選択可能数**: 単一
- **逆方向リンク**: 案件管理テーブルに「関連対応履歴」自動生成

#### 6. 効果測定 → 案件管理
- **フィールド名**: 案件ID（既存）
- **参照テーブル**: 案件管理テーブル
- **参照フィールド**: 案件ID
- **選択可能数**: 単一
- **逆方向リンク**: 案件管理テーブルに「効果測定結果」自動生成

### T3: ルックアップフィールド作成

#### 案件管理テーブルのルックアップ
1. **顧客業界**（ルックアップ）
   - 参照: 顧客名.業界

2. **顧客規模**（ルックアップ）
   - 参照: 顧客名.企業規模

3. **コンサルタント専門分野**（ルックアップ）
   - 参照: 担当コンサルタント.専門分野

4. **関連タスク数**（ルックアップ）
   - 参照: COUNT(関連タスク)

5. **完了タスク数**（ルックアップ）
   - 参照: COUNTIF(関連タスク.ステータス, "完了")

#### プロジェクトタスクテーブルのルックアップ
1. **案件ステータス**（ルックアップ）
   - 参照: 案件ID.ステータス

2. **顧客名**（ルックアップ）
   - 参照: 案件ID.顧客名

#### 顧客マスタのルックアップ
1. **累積案件数**（ルックアップ）
   - 参照: COUNT(関連案件)

2. **累積契約金額**（ルックアップ）
   - 参照: SUM(関連案件.契約金額)

3. **最終対応日**（ルックアップ）
   - 参照: MAX(対応履歴.対応日時)

### T0: 可視性最適化

#### リンクプレビュー設定
1. **顧客マスタの表示**
   - 1番目: 顧客名（主キー）
   - 2番目: 契約ステータス
   - 3番目: 累積契約金額

2. **案件管理の表示**
   - 1番目: 案件ID（主キー）
   - 2番目: ステータス
   - 3番目: 契約金額

3. **タスクの表示**
   - 1番目: タスクID（主キー）
   - 2番目: ステータス
   - 3番目: 期限

## C4: ワークフロー実装

### T1: アラートワークフロー

#### 1. 案件遅延アラート
**ワークフロー名**: 案件期限監視アラート
- **トリガー**: 定期実行（毎日 09:00）
- **対象テーブル**: 案件管理テーブル
- **条件**: 
  - ステータス NOT IN ("導入完了", "キャンセル")
  - AND 残日数 < 7
- **アクション**:
  1. フィールド更新:
     - ステータスアラート = "🚨期限迫る"
     - 最終更新日 = TODAY()
  2. 通知送信:
     - 宛先: @担当コンサルタント
     - メッセージ: "案件：{{案件ID}}の完了予定日まで残り{{残日数}}日です。確認をお願いします。"
  3. タスク作成:
     - テーブル: プロジェクトタスクテーブル
     - タスク名: "期限確認：{{案件ID}}"
     - 優先度: "緊急"
     - 期限: TODAY() + 1

#### 2. タスク遅延アラート
**ワークフロー名**: タスク遅廰監視
- **トリガー**: 定期実行（毎日 10:00）
- **対象テーブル**: プロジェクトタスクテーブル
- **条件**:
  - ステータス IN ("未着手", "進行中")
  - AND 期限 < TODAY()
- **アクション**:
  1. フィールド更新:
     - 遅延フラグ = "🔴遅延"
  2. 通知送信:
     - 宛先: @担当者
     - メッセージ: "タスク：{{タスク名}}が遅延しています。至急対応が必要です。"

#### 3. 顧客満足度低下アラート
**ワークフロー名**: 顧客満足度監視
- **トリガー**: フィールド更新時
- **監視フィールド**: 満足度
- **対象テーブル**: 顧客対応履歴テーブル
- **条件**: 満足度 IN ("不満", "非常に不満")
- **アクション**:
  1. フィールド更新:
     - フォローアップ必要 = TRUE
  2. 通知送信:
     - 宛先: @対応者, @マネージャー
     - メッセージ: "顧客：{{顧客名}}の満足度が低下しています。フォローアップが必要です。"

### T2: 承認ワークフロー

#### 1. 案件承認フロー
**ワークフロー名**: 高額案件承認
- **トリガー**: フィールド更新時
- **監視フィールド**: ステータス
- **条件**: 
  - ステータス = "提案中"
  - AND 提案金額 >= 5,000,000
- **アクション**:
  1. 承認リクエスト:
     - 承認者: マネージャー
     - 期限: 3営業日
     - 承認時アクション:
       - ステータス = "実装中"
       - 承認日 = TODAY()
       - 承認者 = CURRENT_USER()
     - 否認時アクション:
       - ステータス = "保留"
       - 通知: "案件{{案件ID}}は差戻されました。再検討が必要です。"
  2. リマインダー:
     - 1日後: 未承認の場合、承認者に再通知
     - 2日後: 未承認の場合、上位マネージャーにエスカレーション

#### 2. 緊急タスク承認
**ワークフロー名**: 緊急タスク割当承認
- **トリガー**: レコード作成時
- **対象テーブル**: プロジェクトタスクテーブル
- **条件**: 優先度 = "緊急"
- **アクション**:
  1. 承認リクエスト:
     - 承認者: プロジェクトマネージャー
     - 期限: 4時間
     - メッセージ: "緊急タスクが登録されました。承認が必要です。"

### T3: プロセス自動化ワークフロー

#### 1. 案件ステータス自動更新
**ワークフロー名**: 案件進捗自動更新
- **トリガー**: 定期実行（毎日 18:00）
- **対象テーブル**: 案件管理テーブル
- **アクション**:
  1. 進捗率計算:
     - 進捗率 = (完了タスク数 / 関連タスク数) * 100
  2. ステータス更新:
     - IF 進捗率 = 100 AND ステータス = "実装中":
       - ステータス = "導入完了"
       - 実際完了日 = TODAY()

#### 2. 効果測定リマインダー
**ワークフロー名**: 効果測定スケジュール
- **トリガー**: フィールド更新時
- **監視フィールド**: ステータス (案件管理テーブル)
- **条件**: ステータス = "導入完了"
- **アクション**:
  1. 測定タスク作成:
     - テーブル: プロジェクトタスクテーブル
     - タスク名: "1ヶ月後効果測定：{{案件ID}}"
     - 期限: 実際完了日 + 30
     - 担当者: {{担当コンサルタント}}

#### 3. タスクステータス連動
**ワークフロー名**: タスク完了時処理
- **トリガー**: フィールド更新時
- **監視フィールド**: ステータス (プロジェクトタスクテーブル)
- **条件**: ステータス が "完了" に変更された時
- **アクション**:
  1. フィールド更新:
     - 完了日 = TODAY()
     - 進捗率 = 100
  2. 通知:
     - 宛先: @案件担当コンサルタント
     - メッセージ: "タスク：{{タスク名}}が完了しました。"

## C5: ボタン実装

### T1: クイック作成ボタン

#### 1. 🚀タスク作成ボタン（案件管理テーブル）
**ボタン名**: 🚀タスク作成
**配置**: 案件管理テーブルの各レコード
**表示条件**: ステータス IN ("提案中", "実装中")
**アクションフロー**:
1. 現在のレコード情報取得:
   - 案件ID = RECORD_ID()
   - 顧客名 = 顧客名
   - 担当コンサルタント = 担当コンサルタント
2. 新規タスク作成:
   - テーブル: プロジェクトタスクテーブル
   - 初期値:
     - 案件ID = 案件ID
     - タスク名 = "新規タスク"
     - 担当者 = 担当コンサルタント
     - ステータス = "未着手"
     - 優先度 = "中"
     - 期限 = TODAY() + 7
3. 完了通知:
   - メッセージ: "タスクを作成しました"
   - 作成したレコードへのリンク表示

#### 2. 📄提案書作成ボタン（案件管理テーブル）
**ボタン名**: 📄提案書作成
**配置**: 案件管理テーブルの各レコード
**表示条件**: ステータス = "初回相談"
**アクションフロー**:
1. 現在のレコード情報取得:
   - 案件ID = RECORD_ID()
   - 顧客情報 = LOOKUP(顧客名, [業界, 企業規模, DX成熟度])
2. 提案書レコード作成:
   - テーブル: 提案書テーブル
   - 初期値:
     - 案件ID = 案件ID
     - 提案日 = TODAY()
     - 提案内容 = テンプレートから自動生成
     - 承認ステータス = "作成中"
3. ステータス更新:
   - 案件管理.ステータス = "提案中"

#### 3. 📊効果測定開始ボタン（案件管理テーブル）
**ボタン名**: 📊効果測定開始
**配置**: 案件管理テーブルの各レコード
**表示条件**: ステータス = "導入完了"
**アクションフロー**:
1. 測定レコード作成:
   - テーブル: 効果測定テーブル
   - 初期値:
     - 案件ID = RECORD_ID()
     - 測定日 = TODAY()
     - 測定期間 = "1ヶ月後"

### T2: 外部連携ボタン

#### 1. 📧メール送信ボタン（顧客マスタ）
**ボタン名**: 📧メール送信
**配置**: 顧客マスタの各レコード
**アクションフロー**:
1. 連絡先情報取得:
   - メールアドレス = EXTRACT_EMAIL(連絡先)
   - テンプレート = 業界別メールテンプレート
2. メールアプリ起動:
   - URL: `mailto:{{メールアドレス}}?subject=Lark DXサービスのご案内&body={{テンプレート}}`
3. 履歴記録:
   - 顧客対応履歴に自動記録
   - 対応種別 = "その他"
   - 対応内容 = "メール送信：" + 件名

#### 2. 📞電話発信ボタン（顧客マスタ）
**ボタン名**: 📞電話発信
**配置**: 顧客マスタの各レコード
**アクションフロー**:
1. 電話番号取得:
   - 電話番号 = EXTRACT_PHONE(連絡先)
2. 電話アプリ起動:
   - URL: `tel:{{電話番号}}`
3. コールメモ作成:
   - 顧客対応履歴に新規レコード
   - 対応種別 = "問い合わせ"
   - ステータス = "対応中"

#### 3. 📈レポート出力ボタン（案件管理テーブル）
**ボタン名**: 📈レポート出力
**配置**: 案件管理テーブルの各レコード
**アクションフロー**:
1. データ収集:
   - 案件情報
   - 関連タスク情報
   - 効果測定結果
2. PDF生成:
   - テンプレートにデータを流し込み
   - 案件サマリーレポート作成
3. ダウンロード:
   - ファイル名: "案件レポート_{{案件ID}}_{{今日の日付}}.pdf"

### T3: 一括処理ボタン

#### 1. 📋一括ステータス更新（プロジェクトタスクテーブル）
**ボタン名**: 📋一括完了
**配置**: ビューのヘッダー部分
**表示条件**: 管理者権限
**アクションフロー**:
1. 対象レコード特定:
   - 条件: 選択されたレコード
   - 追加条件: ステータス != "完了"
2. 一括更新:
   - ステータス = "完了"
   - 完了日 = TODAY()
   - 進捗率 = 100
3. 結果通知:
   - 処理件数表示
   - 失敗件数表示

#### 2. 📢一括通知送信（顧客マスタ）
**ボタン名**: 📢一括通知
**配置**: ビューのヘッダー部分
**アクションフロー**:
1. 対象顧客特定:
   - 条件: 契約ステータス = "有効"
   - 追加フィルター: ユーザー指定
2. 通知コンテンツ作成:
   - テンプレート選択
   - 変数置換
3. 一括送信:
   - メール通知
   - 送信履歴記録

#### 3. 🗑️一括アーカイブ（案件管理テーブル）
**ボタン名**: 🗑️古い案件をアーカイブ
**配置**: ビューのヘッダー部分
**表示条件**: 管理者権限
**アクションフロー**:
1. 対象特定:
   - 条件: ステータス IN ("導入完了", "キャンセル")
   - AND 実際完了日 < TODAY() - 180
2. アーカイブ処理:
   - アーカイブフラグ = TRUE
   - アーカイブ日 = TODAY()
3. 確認:
   - 処理件数: XX件
   - メッセージ: "アーカイブ完了"

## C6: ビュー作成

### T1: グリッドビュー

#### 1. 案件管理テーブルのビュー

**管理者用ビュー**
- **名称**: 全案件一覧（管理者）
- **表示フィールド**: 全フィールド
- **フィルター**: なし
- **ソート**: 
  - 第1キー: 優先度（降順）
  - 第2キー: 完了予定日（昇順）
- **条件付き書式**:
  - 残日数 < 0: 行全体を赤色
  - 残日数 < 7: 行全体を黄色
  - ステータス = "導入完了": 行全体を緑色

**コンサルタント用ビュー**
- **名称**: 担当案件一覧
- **表示フィールド**: 
  - 案件ID, 顧客名, ステータス, 優先度
  - 完了予定日, 進捗率, ステータスアラート
  - 関連タスク数, 完了タスク数
- **フィルター**: 担当コンサルタント = CURRENT_USER()
- **ソート**: 優先度（降順）, 残日数（昇順）
- **グループ化**: ステータス

**分析用ビュー**
- **名称**: 案件分析ビュー
- **表示フィールド**: 
  - 顧客名, 顧客業界, 顧客規模
  - 提案金額, 契約金額, 契約率
  - リードタイム, ステータス
- **フィルター**: ステータス != "キャンセル"
- **グループ化**: 顧客業界
- **集計行**: 契約金額の合計、平均契約率

#### 2. プロジェクトタスクテーブルのビュー

**アクティブタスクビュー**
- **名称**: 進行中タスク
- **フィルター**: 
  - ステータス IN ("未着手", "進行中")
  - AND 担当者 CONTAINS CURRENT_USER()
- **ソート**: 優先度（降順）, 期限（昇順）
- **条件付き書式**:
  - 遅廰フラグ = "🔴遅延": 行全体を赤色
  - タスク残日数 < 3: 行全体を黄色

**チームタスクビュー**
- **名称**: チーム全体タスク
- **フィルター**: ステータス != "キャンセル"
- **グループ化**: 案件ID
- **ソート**: 案件ID, 期限（昇順）

#### 3. 顧客マスタのビュー

**アクティブ顧客ビュー**
- **名称**: 有効顧客一覧
- **フィルター**: 契約ステータス = "有効"
- **ソート**: 累積契約金額（降順）
- **表示フィールド**:
  - 顧客名, 業界, 企業規模, DX成熟度
  - 担当コンサルタント, 累積案件数, 累積契約金額
  - 最終対応日

### T2: カンバンビュー

#### 1. 案件管理カンバン
**名称**: 案件進捗管理ボード
- **グループ化フィールド**: ステータス
- **列構成**:
  - 初回相談
  - 提案中
  - 実装中
  - 導入完了
  - 保留
- **カード表示**:
  - タイトル: 案件ID
  - サブ情報: 顧客名, 担当コンサルタント
  - タグ: 優先度, 契約金額
  - 日付: 完了予定日
- **色分け**: 優先度による自動色分け
- **WIP制限**: 
  - 提案中: 最大10件
  - 実装中: 最大20件

#### 2. タスク管理カンバン
**名称**: タスク進捗ボード
- **グループ化フィールド**: ステータス
- **列構成**:
  - 未着手
  - 進行中
  - 完了
  - 保留
- **カード表示**:
  - タイトル: タスク名
  - サブ情報: 案件ID, 担当者
  - タグ: 優先度, タスクカテゴリ
  - 進捗バー: 進捗率
- **ドラッグ&ドロップ**: 有効

### T3: カレンダービュー

#### 1. 案件スケジュールカレンダー
**名称**: 案件予定カレンダー
- **日付フィールド**: 完了予定日
- **イベント表示**:
  - タイトル: 案件ID
  - 詳細: 顧客名、ステータス
- **色分け**: ステータスで自動色分け
- **フィルター**: ステータス NOT IN ("導入完了", "キャンセル")

#### 2. タスク期限カレンダー
**名称**: タスク期限カレンダー
- **日付フィールド**: 期限
- **イベント表示**:
  - タイトル: タスク名
  - 詳細: 担当者、進捗率
- **色分け**: 優先度で自動色分け
- **フィルター**: 
  - ステータス != "完了"
  - AND 担当者 CONTAINS CURRENT_USER()

#### 3. 顧客対応スケジュール
**名称**: 対応予定カレンダー
- **日付フィールド**: 対応日時
- **イベント表示**:
  - タイトル: 顧客名
  - 詳細: 対応種別、対応者
- **色分け**: 対応種別で自動色分け

### ガントチャートビュー（オプション）

**案件ガントチャート**
- **名称**: プロジェクトタイムライン
- **開始日フィールド**: 開始日
- **終了日フィールド**: 完了予定日
- **進捗率フィールド**: 進捗率
- **マイルストーン**: 重要日程
- **フィルター**: ステータス != "キャンセル"

### ギャラリービュー（オプション）

**顧客ロゴギャラリー**
- **名称**: 顧客企業ロゴ一覧
- **画像フィールド**: 企業ロゴ（顧客マスタに追加）
- **表示情報**:
  - 顧客名
  - 業界
  - 累積契約金額
- **レイアウト**: 4列表示

## 次のステップ

### C2: フィールド設計・実装
- 各テーブルの詳細フィールド設計
- 主キーの設定（最左端配置）
- 数式フィールドの実装

### C3: リレーション構築
- テーブル間の双方向リンク設定
- ルックアップフィールドの作成

### C4-C10: 自動化とUI構築
- ワークフロー実装
- ビューとダッシュボード作成
- 権限設定とテスト

## 効果測定目標

### 即時効果
- 案件検索時間: 5分 → 30秒（90%削減）
- データ入力時間: 15分 → 5分（67%削減）
- レポート作成時間: 60分 → 5分（92%削減）

### 長期効果
- 月間処理能力: 200件 → 500件（150%向上）
- エラー率: 5% → 0.5%（90%改善）
- 顧客満足度: 3.5 → 4.5（28%向上）

---
作成日: 2025-07-20
作成者: Claude Code